---
const currentPath = Astro.url.pathname;

const navLinks = [
  { href: '/', text: 'Inicio' },
  { href: '/servicios', text: 'Servicios' },
  { href: '/proyectos', text: 'Proyectos' },
  { href: '/nosotros', text: 'Nosotros' },
  { href: '/blog', text: 'Blog' },
  { href: '/contacto', text: 'Contacto' },
];

function isActive(href: string) {
  if (href === '/') return currentPath === '/';
  return currentPath.startsWith(href);
}
---

<header class="sticky top-0 z-50 bg-dark-secondary/95 backdrop-blur-md shadow-lg shadow-primary/10 transition-colors duration-300 border-b border-dark-tertiary">
  <nav class="container mx-auto px-4 py-4">
    <div class="flex justify-between items-center">
      <a href="/" class="flex items-center gap-3 group">
        <img
          src="/logo-bg.png"
          alt="DevHub"
          class="h-12 md:h-14 transition-all duration-300 group-hover:scale-110 group-hover:drop-shadow-[0_0_15px_rgba(255,193,7,0.8)]"
        />
      </a>

      <!-- Desktop Navigation -->
      <ul class="hidden md:flex items-center gap-8">
        {navLinks.map(link => (
          <li>
            <a
              href={link.href}
              class={`font-medium transition-colors pb-1 border-b-2 ${
                isActive(link.href)
                  ? 'text-primary border-primary'
                  : 'text-gray-300 hover:text-primary border-transparent hover:border-primary/50'
              }`}
            >
              {link.text}
            </a>
          </li>
        ))}
        <li>
          <a
            href="https://wa.me/5493834946767"
            target="_blank"
            rel="noopener noreferrer"
            class="px-5 py-2 bg-primary text-dark font-bold rounded-lg hover:bg-primary-dark transition-all duration-300 hover:scale-105 flex items-center gap-2 text-sm"
          >
            <i class="fab fa-whatsapp"></i>
            <span>WhatsApp</span>
          </a>
        </li>
      </ul>

      <!-- Mobile Menu Button -->
      <button
        id="mobileMenuBtn"
        class="md:hidden w-10 h-10 flex flex-col justify-center items-center gap-1.5"
        aria-label="Toggle menu"
      >
        <span class="w-6 h-0.5 bg-primary transition-all" id="line1"></span>
        <span class="w-6 h-0.5 bg-primary transition-all" id="line2"></span>
        <span class="w-6 h-0.5 bg-primary transition-all" id="line3"></span>
      </button>
    </div>

    <!-- Mobile Navigation -->
    <div id="mobileMenu" class="hidden md:hidden mt-4 pb-4 border-t border-dark-tertiary pt-4">
      <ul class="flex flex-col gap-4">
        {navLinks.map(link => (
          <li>
            <a
              href={link.href}
              class={`block font-medium transition-colors ${
                isActive(link.href) ? 'text-primary' : 'text-gray-300 hover:text-primary'
              }`}
            >
              {link.text}
            </a>
          </li>
        ))}
        <li>
          <a
            href="https://wa.me/5493834946767"
            target="_blank"
            rel="noopener noreferrer"
            class="inline-flex items-center gap-2 px-5 py-2 bg-primary text-dark font-bold rounded-lg"
          >
            <i class="fab fa-whatsapp"></i>
            WhatsApp
          </a>
        </li>
      </ul>
    </div>
  </nav>
</header>

<script>
  const btn = document.getElementById('mobileMenuBtn');
  const menu = document.getElementById('mobileMenu');

  btn?.addEventListener('click', () => {
    menu?.classList.toggle('hidden');
  });

  // Close mobile menu on link click
  menu?.querySelectorAll('a').forEach(a => {
    a.addEventListener('click', () => menu.classList.add('hidden'));
  });
</script>